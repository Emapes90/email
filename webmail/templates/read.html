{% extends "base.html" %} {% block title %}{{ message.subject }} â€” {{ app_name
}}{% endblock %} {% block body %}
<div class="app-layout">
  {% include "_sidebar.html" %}

  <div class="main-content">
    <div class="top-bar">
      <a
        href="{{ url_for('mail.inbox', folder=folder) }}"
        class="btn btn-ghost btn-icon"
      >
        <i class="fas fa-arrow-left"></i>
      </a>
      <span class="top-bar-title">{{ folder|capitalize }}</span>
      <div class="top-bar-actions" style="margin-left: auto">
        <a
          href="{{ url_for('mail.compose', reply_to=message.from_email, subject='Re: ' + message.subject) }}"
          class="btn btn-secondary btn-sm"
          data-tooltip="Reply"
        >
          <i class="fas fa-reply"></i> Reply
        </a>
        <a
          href="{{ url_for('mail.compose', reply_to='', subject='Fwd: ' + message.subject) }}"
          class="btn btn-secondary btn-sm"
          data-tooltip="Forward"
        >
          <i class="fas fa-share"></i> Forward
        </a>
        <button
          class="btn btn-ghost btn-icon"
          data-tooltip="Archive"
          onclick="ProMail.moveEmail('{{ message.uid }}','{{ folder }}','archive')"
        >
          <i class="fas fa-archive"></i>
        </button>
        <button
          class="btn btn-ghost btn-icon"
          data-tooltip="Delete"
          onclick="ProMail.deleteEmail('{{ message.uid }}','{{ folder }}')"
        >
          <i class="fas fa-trash-alt"></i>
        </button>
      </div>
    </div>

    <div class="message-view">
      <div class="message-header">
        <h1 class="message-subject">{{ message.subject }}</h1>

        <div class="message-info">
          <div class="message-sender-avatar">
            {{ message.from_name[0]|upper if message.from_name else '?' }}
          </div>
          <div class="message-sender-details">
            <div class="message-sender-name">
              {{ message.from_name or message.from_email }}
            </div>
            <div class="message-sender-email">
              &lt;{{ message.from_email }}&gt; to {{ message.to }}
            </div>
          </div>
          <span class="message-date">{{ message.date_str }}</span>
        </div>
      </div>

      <div class="message-body">
        {% if message.body_html %} {{ message.body_html|safe }} {% else %}
        <pre
          style="
            white-space: pre-wrap;
            font-family: var(--font-sans);
            color: var(--text-secondary);
          "
        >
{{ message.body_text }}</pre
        >
        {% endif %}
      </div>

      {% if message.attachments %}
      <div class="message-attachments">
        <h3>
          <i class="fas fa-paperclip"></i> Attachments ({{
          message.attachments|length }})
        </h3>
        {% for att in message.attachments %}
        <div class="attachment-item">
          <div class="attachment-icon">
            <i class="fas fa-file"></i>
          </div>
          <div class="attachment-info">
            <div class="attachment-name">{{ att.filename }}</div>
            <div class="attachment-size">
              {{ (att.size / 1024)|round(1) }} KB
            </div>
          </div>
          <button class="btn btn-ghost btn-sm">
            <i class="fas fa-download"></i>
          </button>
        </div>
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
